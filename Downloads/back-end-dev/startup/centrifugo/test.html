<html>
  <head>
    <title>Centrifugo quick start</title>
  </head>

  <body>
    <div id="counter">-</div>
    <script src="https://unpkg.com/centrifuge@5.2.2/dist/centrifuge.js"></script>
    <script type="text/javascript">
      const container = document.getElementById('counter');

      const centrifuge = new Centrifuge('ws://localhost:8000/connection/websocket', {
        token:
          'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwiY29udGV4dCI6IlBMQVlFUiIsInR5cGUiOiJBQ0NFU1MiLCJzZXNzaW9uSWQiOiJiMGM3OGM4NS0wZDU4LTRhNGYtOTQ0YS04NGRiMzAzNGE5Y2YiLCJjaGFubmVscyI6WyJwbGF5ZXIjMSJdLCJpYXQiOjE3NDA0OTA3NDksImV4cCI6MTc0MDQ5NDM0OX0._7YrCD3s09yW4lgy96dFFaA2uQfstgS5is46hoCoCEk',
      });

      centrifuge
        .on('connecting', function (ctx) {
          console.log(`connecting: ${ctx.code}, ${ctx.reason}`);
        })
        .on('connected', function (ctx) {
          console.log(`connected over ${ctx.transport}`);
        })
        .on('disconnected', function (ctx) {
          console.log(`disconnected: ${ctx.code}, ${ctx.reason}`);
        })
        .connect();

      const sub = centrifuge.newSubscription('player#1');

      sub
        .on('publication', function (ctx) {
          container.innerHTML = ctx.data.value;
          document.title = ctx.data.value;
        })
        .on('subscribing', function (ctx) {
          console.log(`subscribing: ${ctx.code}, ${ctx.reason}`);
        })
        .on('subscribed', function (ctx) {
          console.log('subscribed', ctx);
        })
        .on('unsubscribed', function (ctx) {
          console.log(`unsubscribed: ${ctx.code}, ${ctx.reason}`);
        })
        .subscribe();
    </script>
  </body>
</html>
